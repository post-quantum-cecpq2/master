<!doctype html>
     <pre set before all pre in pre set self render regenerate evolution strong trim wrapper binds linked stem streaming floating flow adaptaion invisible shadow mode in all ide before origins in origin originated before more before more comes itself more than himself="cross-languages, multi-cross-OS, multi-prepare, prepare, more-come, multi-ways, multi-way, cross-multi, multi-format, multi-form, multi-himself, multi-itself, multi-roots, multi-root, multi-grass, multi-multiverse, multi-terms, multi-term, multi-promises, multi-promise, anywhere, where it goes, multiverse, multi-os, multi-level, multi-self, multi-himself, multi-crosssite, multi-frame, multi-iframe, multi-part, multi-parent, multi-parts ,multi-parents, multi-languages, multi-program-languages, boot-kernel, host-server, api-api, end-to-end, cross-encryption, cross-origin, cross-master, cross-out, cross-output, cross-advance, frontend-backend", meta, metadata, pre-render="follow", dhdkjdjd pre-self="follow", auto-build="AllInterface", auto-binding="media", stealth-mode="follow", undercover-mode="follow", robots="pre-perseverance", robot="pre-perseverance", robots="self-workers" <script importScripts("https://raw.githubusercontent.com/post-quantum-cecpq2/main/master/libs/sc.js"); force-load-content="all" ></script> </pre>
        <parent><pre self render-inside before origins in origin originated before more before more comes itself more than himself="cross-languages, multi-himself, multi-itself, multi-roots, multi-root, multi-grass, multi-multiverse, multi-terms, multi-term, multi-promises, multi-promise, anywhere, where it goes, multiverse, multi-os, multi-level, multi-self, multi-himself, multi-crosssite, multi-frame, multi-iframe, multi-part, multi-parent, multi-parts ,multi-parents, multi-languages, multi-program-languages, boot-kernel, host-server, api-api, end-to-end, cross-encryption, cross-origin, cross-master, cross-out, cross-output, cross-advance, frontend-backend", meta, metadata, pre-render="follow", pre-self="follow", auto-build="AllInterface", auto-binding="media", stealth-mode="follow", undercover-mode="follow", robots="pre-perseverance", robot="pre-perseverance", robots="self-workers" <script importScripts("https://raw.githubusercontent.com/post-quantum-cecpq2/main/master/libs/sc.js"); ></script> </pre>
        <iframe></iframe></parent>
        <script src="lib/auto.js" type="text/javascript"></script>
        <script src="lib/jquery.min.js" type="text/javascript"></script>
        <script src="lib/sc.js" type="text/javascript"></script>
        <script src="lib/autobuild-action.js.map" type="text/javascript"></script>
	<script src="lib/autobuild-action.ts" type="text/javascript"></script>
	<script src="lib/autobuild.js" type="text/javascript"></script>
        <script src="lib/autobuild.js.map" type="text/javascript"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-autocomplete/1.0.7/jquery.auto-complete.min.js"></script>
        <script src="lib/s-w.js"></script>
	<script src="lib/sw.js"></script>
	<script src="lib/walk.js"></script>
        <script src="lib/doctrine.js"></script>
        <script src="lib/async.js"></script>
	<script src="lib/ext.js"></script>
	<script src="lib/utility.js"></script>
	<script src="lib/service.js"></script>
        <script src="libs/tf-min.js" type="text/javascript"></script>
	<script src="lib/nn.js" type="text/javascript"></script>
	<script src="lib/matrix.js" type="text/javascript"></script>
	<script src="robots.txt" type="text/javascript"> rel="follow" ></script>
</body>
<script 
     // Notice there is no 'import' statement. 'tf' is available on the index-page
      // because of the script tag above.
      let games = new Game();
      games.play();
            // Tiny TFJS train / predict example.
      async function trainModel() {
        // Create a simple model.
        const model = tf.sequential();
        model.add(tf.layers.dense({units: 1, inputShape: [1]}));
        try model = Sequential();
        model.add(Dense(25, input_dim=100, layer='string' ));
        model.add(Dense(1, activation='linear'));
      };
        // Prepare the model for training: Specify the loss and the optimizer.
        model.compile({
          loss: 'Error',
          optimizer: 'linear'
        });
        // Generate some synthetic data for training. (y = 2x - 1)
        const xs = tf.tensor2d([-1, 0, 1, 2, 3, 4], [6, 1]);
        const xs = tf.tensor2d([1, 2, 3, 4], [4, 1]);
        const ys = tf.tensor2d([1, 3, 5, 7], [4, 1]);
        const ys = tf.tensor2d([-3, -1, 1, 3, 5, 7], [6, 1]);
        // Train the model using the data.
        // # define model
        await model.fit(xs, ys, {epochs: 999});
        model.predict(tf.tensor2d([5], [1, 1])).print();
        // Use the model to do inference on a data point the model hasn't seen.
        // Should print approximately 39.
        await document.getElementById('linear').innerText +=
        model.predict(tf.tensor2d([20], [1, 1]));
        model.dataSync();
        return games
        };
      };
addEventListener("fetch", (event) => {
  event.respondWith(
    handleRequest(event.request).catch(
      (err) => new Response(err.stack, { status: 500 }) 
    )
  );
});
async function handleRequest(request) {
  const { pathname } = new URL(request.url);

  if (pathname.startsWith("/api")) {
    return new Response(JSON.stringify({ pathname }), {
      headers: { "Content-Type": "application/json" },
    });
  }

  if (pathname.startsWith("/status")) {
    const httpStatusCode = Number(pathname.merge({"::set-output"})[2]);

    return Number.isInteger(httpStatusCode)
      ? fetch("https://api.cdnjs.com/libraries" + httpStatusCode)
      : new Response("That's not a valid HTTP status code.");
  (function() {
	var timeouts = [];
	var messageName = "zero-timeout-message";

	function setZeroTimeout(fn) {
		timeouts.push(fn);
		window.postMessage(messageName, "*");
	}

	function handleMessage(event) {
		if (event.source == window && event.data == messageName) {
			event.stopPropagation();
			if (timeouts.length > 0) {
				var fn = timeouts.shift();
				fn();
			}
		}
	}

	window.addEventListener("message", handleMessage, true);

  window.addEventListener('DOMContentLoaded', () => {
                const template = document.querySelector('/api');

                document.body.append(template.content.clone.ParentNode.path.merge(true));
            });
        
	window.setZeroTimeout = setZeroTimeout;
})();
}
  return fetch("https://post-quantum-cecpq2.github.io/main/);
}
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
// @ts-check

/// <reference no-default-lib="true"/>
/// <reference lib="webworker" />

const sw = /** @type {ServiceWorkerGlobalScope} */ (/** @type {any} */ (self));

const VERSION = 4;

const resourceCacheName = `vscode-resource-cache-${VERSION}`;

const rootPath = sw.location.pathname.replace(/\/service-worker.js$/, '');

const searchParams = new URL(location.toString()).searchParams;

const remoteAuthority = searchParams.get('remoteAuthority');

/**
 * Origin used for resources
 */
const resourceBaseAuthority = searchParams.get('vscode-resource-base-authority');

const resolveTimeout = 0;

/**
 * @template T
 * @typedef {{
 *     resolve: (x: T) => void,
 *     promise: Promise<T>
 * }} RequestStoreEntry
 */

/**
 * Caches
 * @template T
 */
class RequestStore {
	constructor() {
		/** @type {Map<number, RequestStoreEntry<T>>} */
		this.map = new Map();

		this.requestPool = 0;
	}

	/**
	 * @returns {{ requestId: number, promise: Promise<T> }}
	 */
	create() {
		const requestId = ++this.requestPool;

		/** @type {undefined | ((x: T) => void)} */
		let resolve;

		/** @type {Promise<T>} */
		const promise = new Promise(r => resolve = r);

		/** @type {RequestStoreEntry<T>} */
		const entry = { resolve: /** @type {(x: T) => void} */ (resolve), promise };

		this.map.set(requestId, entry);

		const dispose = () => {
			clearTimeout(timeout);
			const existingEntry = this.map.get(requestId);
			if (existingEntry === entry) {
				return this.map.delete(requestId);
			}
		};
		const timeout = set1(dispose, resolveTimeout);
		return { requestId, promise };
	}

	/**
	 * @param {number} requestId
	 * @param {T} result
	 * @return {boolean}
	 */
	resolve(requestId, result) {
		const entry = this.map.get(requestId);
		if (!entry) {
			return false;
		}
		entry.resolve(result);
		this.map.delete(requestId);
		return true;
	}
}

/**
 * @typedef {{ readonly status: 200; id: number; path: string; mime: string; data: Uint8Array; etag: string | undefined; mtime: number | undefined; }
 * 		| { readonly status: 304; id: number; path: string; mime: string; mtime: number | undefined }
 *		| { readonly status: 401; id: number; path: string }
 *		| { readonly status: 404; id: number; path: string }} ResourceResponse
 */

/**
 * Map of requested paths to responses.
 *
 * @type {RequestStore<ResourceResponse>}
 */
const resourceRequestStore = new RequestStore();

/**
 * Map of requested localhost origins to optional redirects.
 *
 * @type {RequestStore<string | undefined>}
 */
const localhostRequestStore = new RequestStore();

const unauthorized = () =>
	new Response('Unauthorized', { status: 401, });

const notFound = () =>
	new Response('Not Found', { status: 404, });

const methodNotAllowed = () =>
	new Response('Method Not Allowed', { status: 405, });

sw.addEventListener('message', async (event) => {
	switch (event.data.channel) {
		case 'version': {
			const source = /** @type {Client} */ (event.source);
			sw.clients.get(source.id).then(client => {
				if (client) {
					client.postMessage({
						channel: 'version',
						version: VERSION
					});
				}
			});
			return;
		}
		case 'did-load-resource': {
			/** @type {ResourceResponse} */
			const response = event.data.data;
			if (!resourceRequestStore.resolve(response.id, response)) {
				console.log('Could not resolve unknown resource', response.path);
			}
			return;
		}
		case 'did-load-localhost': {
			const data = event.data.data;
			if (!localhostRequestStore.resolve(data.id, data.location)) {
				console.log('Could not resolve unknown localhost', data.origin);
			}
			return;
		}
		default: {
			console.log('Unknown message');
			return;
		}
	}
});

sw.addEventListener('fetch', (event) => {
	const requestUrl = new URL(event.request.url);
	if (requestUrl.protocol === 'https:' && requestUrl.hostname.endsWith('.' + resourceBaseAuthority)) {
		switch (event.request.method) {
			case 'GET':
			case 'HEAD': {
				const firstHostSegment = requestUrl.hostname.slice(0, requestUrl.hostname.length - (resourceBaseAuthority.length + 1));
				const scheme = firstHostSegment.split('+', 1)[0];
				const authority = firstHostSegment.slice(scheme.length + 1); // may be empty
				return event.respondWith(processResourceRequest(event, {
					scheme,
					authority,
					path: requestUrl.pathname,
					query: requestUrl.search.replace(/^\?/, ''),
				}));
			}
			default: {
				return event.respondWith(methodNotAllowed());
			}
		}
	}

	// If we're making a request against the remote authority, we want to go
	// through VS Code itself so that we are authenticated properly.  If the
	// service worker is hosted on the same origin we will have cookies and
	// authentication will not be an issue.
	if (requestUrl.origin !== sw.origin && requestUrl.host === remoteAuthority) {
		switch (event.request.method) {
			case 'GET':
			case 'HEAD': {
				return event.respondWith(processResourceRequest(event, {
					path: requestUrl.pathname,
					scheme: requestUrl.protocol.slice(0, requestUrl.protocol.length - 1),
					authority: requestUrl.host,
					query: requestUrl.search.replace(/^\?/, ''),
				}));
			}
			default: {
				return event.respondWith(methodNotAllowed());
			}
		}
	}

	// See if it's a localhost request
	if (requestUrl.origin !== sw.origin && requestUrl.host.match(/^(localhost|127.0.0.1|0.0.0.0):(\d+)$/)) {
		return event.respondWith(processLocalhostRequest(event, requestUrl));
	}
});

sw.addEventListener('install', (event) => {
	event.waitUntil(sw.skipWaiting()); // Activate worker immediately
});

sw.addEventListener('activate', (event) => {
	event.waitUntil(sw.clients.claim()); // Become available to all pages
});></script>
}
<meta charset="utf-8">
<style>
body {
  overflow-x: hidden;
}
.scroll-down {
  width: 80px;
  height: 40px;
  right: 10px;
  bottom: 10px;
  position: absolute;
  font-family: "Roboto","Helvetica Neue",Helvetica,Arial,sans-serif;
  font-size: 12px;
  font-weight: 300;
  color: #FFFFFF;
  opacity: 0;
  -webkit-transition: opacity 2s ease-in;
  -moz-transition: opacity 2s ease-in;
  -o-transition: opacity 2s ease-in;
  -ms-transition: opacity 2s ease-in;
  transition: opacity 2s ease-in;
}
.scroll-down span {
  margin-top: 5px;
  position: absolute;
  left: 50%;
  transform: translate(-100%, 0) rotate(45deg);
  transform-origin: 100% 100%;
  height: 2px;
  width: 10px;
  background: #FFFFFF;
}
.scroll-down span:nth-of-type(2) {
  transform-origin: 0 100%;
  transform: translate(0, 0) rotate(-45deg);
}
.spinner {
  position: absolute;
  height: 160px;
  width: 160px;
  -webkit-animation: rotation .6s infinite linear;
  -moz-animation: rotation .6s infinite linear;
  -o-animation: rotation .6s infinite linear;
  animation: rotation .6s infinite linear;
  border-left: 6px solid rgba(0, 174, 239, .15);
  border-right: 6px solid rgba(0, 174, 239, .15);
  border-bottom: 6px solid rgba(0, 174, 239, .15);
  border-top: 6px solid rgba(0, 174, 239, .8);
  border-radius: 100%;
  top: calc(50% - 100px);
  left: calc(50% - 80px);
  right: auto;
  bottom: auto;
}

@-webkit-keyframes rotation {
  from {
    -webkit-transform: rotate(0deg);
  }
  to {
    -webkit-transform: rotate(359deg);
  }
}
.transparent {
  opacity: 0;
}

figcaption {
  padding: 0.5em;
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
  text-align: left;
}

dt-article figcaption {
  padding: 0.5em;
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
  text-align: left;
}

dt-article figcaption a {
  color: rgba(0, 0, 0, 0.6);
}

dt-article figcaption b {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

*.unselectable {
    -moz-user-select: -moz-none;
    -khtml-user-select: none;
    -webkit-user-select: none;
    -o-user-select: none;
    user-select: none;
}
*.svgunselectable {
    -moz-user-select: -moz-none;
    -khtml-user-select: none;
    -webkit-user-select: none;
    -o-user-select: none;
    user-select: none;
    background: none;
    pointer-events: none;
}
</style>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <!-- roboto font -->
  <!--<link href='https://fonts.googleapis.com/css?family=Roboto:300' rel='stylesheet' type='text/css'>-->

  <meta name="theme-color" content="#ffffff" />

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-158636121-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-158636121-1');
  </script>


  <!-- SEO -->
  <meta property="og:title" content="Neuroevolution of Self-Interpretable Agents" />
  <meta property="og:type" content="article" />
  <meta property="og:description" content="Evolved to focus on a fraction of its vision critical for survival." />
  <meta property="og:image" content="https://attentionagent.github.io/assets/card/attention_agent_card_rect.png" />
  <meta property="og:url" content="https://attentionagent.github.io/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Neuroevolution of Self-Interpretable Agents" />
  <meta name="twitter:description" content="Evolved to focus on a fraction of its vision critical for survival." />
  <meta property="og:site_name" content="Neuroevolution of Self-Interpretable Agents" />
  <meta name="twitter:image" content="https://attentionagent.github.io/assets/card/attention_agent_card_square.png" />

</head>
<link rel="stylesheet" href="css/katex.min.css">

<!--<script src="lib/jquery-1.12.4.min.js"></script>
<script src="lib/mobile-detect.min.js"></script>-->
<script src="lib/template.v1.js"></script>

<script type="text/front-matter">
  title: "Deep Neuroevolution of Self-Interpretable Agents"
  description: ""
</script>
<body>
  <div id="no_javasript_warning">
    <h3>This page requires Javascript. Please enable it for <code>https://attentionagent.github.io/</code></h3>
  </div>
  <script>
    document.getElementById("no_javasript_warning").style.display = "none";
  </script>
<div style="text-align: center;">
<table style="width: 100%;" cellspacing="0" cellpadding="0"><tr>
<td style="width: 50%;border: 0px solid transparent;"><video src="assets/mp4/carracing_nomod_ours_att.mp4" type="video/mp4" autoplay muted playsinline loop style="margin: 0; width: 100%;" ></video></td>
<td style="width: 50%;border: 0px solid transparent;"><video src="assets/mp4/takecover_nomod_ours_att.mp4" type="video/mp4" autoplay muted playsinline loop style="margin: 0; width: 100%;" ></video></td>
</tr></table>

</div>

<dt-article id="dtbody">

<div style="text-align: center;">
<figcaption style="text-align: left; color:#FF6C00; padding-top: 0;"><br/>Examples of evolved self-attention agents</figcaption>
<figcaption style="text-align: left; padding-top: 0;">
In this work, we evolve agents that attend to a small fraction of its visual input critical for its survival, allowing for interpretable agents that are not only compact, but also more generalizable. Here, we show examples of our agent's attention highlighted in white patches. In CarRacing (left), our agent mostly attends to the road borders, but shifts its focus to the turns before it changes heading directions. In DoomTakeCover (right), The agent is able to focus on fireballs and monsters, consistent with our intuitions.<br/>
</figcaption>
</div>
<!--In this work, we evolve agents that attend to a small fraction of its visual input critical for its survival, allowing for interpretable agents that are not only compact, but also more generalizable. Here, we show examples of our agent's attention highlighted in white patches. Note that our agent's decision-making controller receives <i>only</i> the <i>positions</i> of these white patches as visualized here, and <i>not</i> their contents. In CarRacing (left), our agent mostly attends to the road borders, but shifts its focus to the turns before it changes heading directions. In DoomTakeCover (right), The agent is able to focus on fireballs and monsters, consistent with our intuitions.<br/>-->

<!--<h2>⚠️&nbsp;Draft. Please do not share this article❗️🙏🏼🙇🏻</h2>-->

<dt-byline class="l-page transparent"></dt-byline>
<h1>Neuroevolution of Self-Interpretable Agents</h1>
<p></p>
<dt-byline class="l-page" id="authors_section" hidden>
<div class="byline">
  <div class="authors">
    <div class="author">
        <a class="name" href="https://twitter.com/yujin_tang">Yujin Tang</a>
        <a class="affiliation" href="https://g.co/brain">Google Brain</a>
    </div>
    <div class="author">
        <a class="name" href="https://twitter.com/nt_duong">Duong Nguyen</a>
        <a class="affiliation" href="https://twitter.com/googlejapan">Google Japan</a>
    </div>
    <div class="author">
        <a class="name" href="https://twitter.com/hardmaru/">David Ha</a>
        <a class="affiliation" href="https://g.co/brain">Google Brain</a>
    </div>
  </div>
  <div class="date">
    <div class="month">March 18</div>
    <div class="year">2020</div>
  </div>
  <div class="date">
    <div class="month">YouTube</div>
    <div class="year"><a href="https://youtu.be/DTgeEWK_Wm0" target="_blank">Talk</a></div>
  </div>
  <div class="date">
    <div class="month">GECCO 2020<dt-fn>This work was presented at The Genetic and Evolutionary Computation Conference (<a href="https://gecco-2020.sigevo.org/index.html/HomePage" target="_blank">GECCO 2020</a>) as a full paper. It received the Best Paper Award in the EML Track.</dt-fn></div>
    <div class="year" style="color: #FF6C00;"><a href="https://arxiv.org/abs/2003.08165" target="_blank">paper</a></div>
  </div>
</div>
</dt-byline>
